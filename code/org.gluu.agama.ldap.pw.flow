Flow org.gluu.agama.ldap.pw
     Basepath ""
     Configs conf
// Start execution of the password validation flow.
Log "@info Start execution of the password validation flow."
// Create json variable for UI feedback.
uiFeedback = {}
// Get an instance of PasswordService Class.
validationService = Call org.gluu.agama.ldap.pw.PasswordService#getInstance conf
// Iterate x times max
count = Repeat 6 times max
     // Retrieve user credentials from UI.
     credentials = RRF "login-basic.ftlh" uiFeedback
     Log "@info User credentials collected successfully!"
// The login flow will end here with failure.
Log "@info The maximum login attempt has been reached!"
// Maximum attempts reached. Password validation failed!
it_suorb = {success:false, error: "Password validation failed!"}
Finish it_suorb